(this.webpackJsonpapp=this.webpackJsonpapp||[]).push([[0],{101:function(e,t,n){e.exports=n(151)},106:function(e,t,n){},137:function(e,t,n){},141:function(e,t,n){},149:function(e,t,n){},150:function(e,t,n){},151:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(16),o=n.n(c),i=(n(106),n(10)),l=n(5),u=n(85),s=n.n(u),m=(n(137),n(90)),d=n(179),f=n(181),v=Object(d.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),borderColor:"white",color:"white",transition:"0.3s","&:hover":{borderColor:"#277da1",color:"#277da1"}}}}}));function E(e){var t=e.text,n=e.onClick,a=e.style,c=v();return r.a.createElement("div",{className:c.root},r.a.createElement(f.a,{onClick:n&&n,style:a&&a,variant:"outlined"},t||"Enter text"))}var h=Object(d.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),borderColor:"white",color:"white",transition:"0.3s","&:hover":{borderColor:"#90be6d",color:"#90be6d"}}}}}));function b(e){var t=e.text,n=e.onClick,a=e.style,c=h();return r.a.createElement("div",{className:c.root},r.a.createElement(f.a,{onClick:n&&n,style:a&&a,variant:"outlined"},t||"Enter text"))}var w=Object(d.a)((function(e){return{root:{"& > *":{margin:e.spacing(1),borderColor:"white",color:"white",transition:"0.3s","&:hover":{borderColor:"#f94144",color:"#f94144"}}}}}));function g(e){var t=e.text,n=e.onClick,a=e.style,c=w();return r.a.createElement("div",{className:c.root},r.a.createElement(f.a,{onClick:n&&n,style:a&&a,variant:"outlined"},t||"Enter text"))}var O=Object(d.a)((function(e){return{root:{"& > *":{backgroundColor:"#6441a5",color:"white",transition:"0.3s ease-in-out","&:hover":{color:"white",borderColor:"#6441a5"}}}}}));function p(e){var t=e.text,n=e.onClick,a=e.style,c=O();return r.a.createElement("div",{className:c.root},r.a.createElement(f.a,{onClick:n&&n,style:a&&a,variant:"outlined"},t||"Enter text"))}n(141);var j=n(86),C=n.n(j),y=n(182),k=Object(d.a)({deleteIcon:{color:"#f94144"}}),N=function(e){var t=e.item,n=e.index,c=k(),o=Object(a.useContext)(H),l=o.setVideoQueue,u=o.admin,s=Object(a.useState)(),m=Object(i.a)(s,2),d=m[0],f=m[1];Object(a.useEffect)((function(){fetch("https://noembed.com/embed?url=".concat(t)).then((function(e){return e.json()})).then((function(e){f(e.title)}))}),[t]);return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"queueItem"},r.a.createElement("a",{href:t,target:"_blank",rel:"noopener noreferrer"},n+1,". ",d||t),u&&r.a.createElement("div",{className:"remove"},r.a.createElement(y.a,{className:c.deleteIcon,onClick:function(){l((function(e){return e.filter((function(e,t){return n!==t}))}))}},r.a.createElement(C.a,null)))))},x=function(){var e=Object(a.useContext)(H).videoQueue.map((function(e,t){return r.a.createElement(N,{item:e,index:t,key:t})}));return r.a.createElement("div",{className:"queue"},e)},L=n(88),A=n.n(L),D=n(87),R=n.n(D),S=function(){var e,t=Object(a.useContext)(H),n=t.twitchUserData,c=t.websiteURL,o=t.admin,u=t.setAdmin,s=t.setCurrentVideoLink,d=t.socket,f=t.setVideoQueue,v=t.videoQueue,h=t.setMaxDelay,w=t.maxDelay,O=t.chatRef,j=Object(a.useState)(),C=Object(i.a)(j,2),y=C[0],k=C[1],N=Object(l.h)().twitchStreamer;void 0===N&&(N="victorowsky_"),N=null===(e=N)||void 0===e?void 0:e.toLowerCase();var L=Object(a.useRef)(null);Object(a.useEffect)((function(){var e=function(){var e;L.current&&(L.current.style.width=(null===O||void 0===O||null===(e=O.current)||void 0===e?void 0:e.offsetWidth)+"px")};return window.addEventListener("resize",e),L.current&&e(),function(){window.removeEventListener("resize",e)}}),[O,L.current,N]),Object(a.useEffect)((function(){if(n)return n.login.toLowerCase()===N.toLowerCase()&&(o||u(!0)),function(){o&&u(!1)}}),[n,u,N,o]),Object(a.useEffect)((function(){if(o)return d.emit("adminQueueUpdate",{videoQueue:v,currentRoom:N}),function(){d.removeAllListeners("adminQueueUpdate")}}),[v,d,N,o]);var D=function(){y&&(s(y),k(""))},S=function(e){"increment"===e?h((function(e){return e+1})):"decrement"===e&&h((function(e){return e>2?e+-1:e}))};return r.a.createElement(r.a.Fragment,null,o?r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"adminPanel"},r.a.createElement("form",null,r.a.createElement("input",{type:"text",value:y,placeholder:"VIDEO URL",onChange:function(e){o&&k(e.target.value)}}),r.a.createElement("button",{style:{display:"none"},onClick:function(e){e.preventDefault(),D()},type:"submit"}),r.a.createElement("div",{className:"optionButtons"},r.a.createElement(b,{text:"PLAY NOW",onClick:D}),r.a.createElement(E,{text:"ADD TO QUEUE",onClick:function(){y&&(f((function(e){return[].concat(Object(m.a)(e),[y])})),k(""))}}),r.a.createElement(g,{text:"SKIP",onClick:function(){o&&v&&(s(v[0]),f((function(e){return e.slice(1)})))}}),r.a.createElement(p,{text:"LOGOUT",onClick:function(){window.location.href="".concat(c,"/twitch/logout")}}))),n&&r.a.createElement("div",{className:"accountInfo"},r.a.createElement("div",{className:"img"},r.a.createElement("img",{src:n.image,alt:"twitchImage",srcSet:""})),n.login)),r.a.createElement(x,null)):r.a.createElement("div",{className:"delayInfoContainer"},r.a.createElement(x,null),r.a.createElement("div",{className:"delay",ref:L},r.a.createElement("span",{className:"delayInfo"},"Max Delay: ",w," seconds"),r.a.createElement("div",{className:"delayManage"},r.a.createElement("div",{className:"delayManageOptionDecrement",onClick:function(){return S("decrement")}},r.a.createElement(R.a,null)),r.a.createElement("div",{className:"delayManageOptionIncrement",onClick:function(){return S("increment")}},r.a.createElement(A.a,null))),n?r.a.createElement("div",{className:"accountInfo"},r.a.createElement("a",{href:"/#/".concat(n.login.toLowerCase()),target:"_blank",rel:"noopener noreferrer"},r.a.createElement("div",{className:"img"},r.a.createElement("img",{src:n.image,alt:"Profile"})),n.login)):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"twitchLoginButton"},r.a.createElement(p,{text:"LOGIN WITH TWITCH",onClick:function(){window.location.href="".concat(c,"/auth/twitch")}}))))))},I=n(89),T=n.n(I),U=(n(149),function(){var e=Object(l.g)(),t=Object(l.h)().twitchStreamer;void 0===t&&(t="victorowsky_");var n=t=t.toLowerCase();["szkajpur","victorowsky_"].forEach((function(e){n===e&&(n="demonzz1")}));var c=Object(a.useState)(null),o=Object(i.a)(c,2),u=o[0],s=o[1],m=Object(a.useState)(t),d=Object(i.a)(m,2),f=d[0],v=d[1],E=Object(a.useContext)(H),h=E.admin,b=E.setCurrentVideoLink,w=E.currentVideoLink,g=E.socket,O=E.setAdmin,p=E.videoQueue,j=E.setVideoQueue,C=E.maxDelay,y=E.chatRef,k=Object(a.useState)(!1),N=Object(i.a)(k,2),x=N[0],L=N[1],A=Object(a.useRef)(),D=window.location.host;Object(a.useEffect)((function(){var e;return h&&(e=setInterval((function(){g.emit("adminData",{currentRoom:f,currentSeconds:A.current.getCurrentTime(),videoQueue:p})}),3e3)),function(){clearInterval(e)}}),[h,g,f,p]),Object(a.useEffect)((function(){h&&g.emit("videoChange",{currentVideoLink:w,currentRoom:f})}),[w,g]),Object(a.useEffect)((function(){window.addEventListener("beforeunload",(function(e){e.preventDefault(),g.emit("leaveRoom",{currentRoom:f})})),v(t)}),[e.pathname]),Object(a.useEffect)((function(){return g.emit("joinRoom",{currentRoom:f}),function(){g.emit("leaveRoom",{currentRoom:f}),O(!1)}}),[f]),Object(a.useEffect)((function(){return g.on("onlineUsersAnswer",(function(e){var t=e.onlineUsers;s(t)})),g.on("joinRoomAnswer",(function(e){var t=e.docs;b(t.currentVideoLink),j(t.queue)})),h||(g.on("videoChangeAnswer",(function(e){var t=e.currentVideoLink;b(t)})),g.on("isPlayingSocketAnswer",(function(e){var t=e.isPlaying;L(t)})),g.on("adminDataAnswer",(function(e){var t=e.currentSeconds,n=e.videoQueue;j(n),function(e,t){if(e.current){var n=e.current.getDuration(),a=e.current.getCurrentTime();n>t?a-C<t&&a+C>t||e.current.seekTo(t,"seconds"):a<n+6&&a>n-6||e.current.seekTo(n,"seconds")}}(A,t)})),g.on("adminQueueUpdateAnswer",(function(e){var t=e.videoQueue;j(t)}))),function(){g.removeAllListeners("adminDataAnswer"),g.removeAllListeners("joinRoomAnswer"),g.removeAllListeners("isPlayingSocketAnswer"),g.removeAllListeners("videoChangeAnswer"),g.removeAllListeners("adminQueueUpdateAnswer"),g.removeAllListeners("onlineUsersAnswer")}}),[f,h,g,C]);return r.a.createElement("div",{className:"videoAndChat"},r.a.createElement("div",{className:"playerAndChat"},r.a.createElement("div",{className:"player-wrapper"},r.a.createElement(T.a,{ref:A,onPlay:function(){h&&(L(!0),g.emit("isPlaying",{isPlaying:!0,currentRoom:f}))},onPause:function(){h&&(L(!1),g.emit("isPlaying",{isPlaying:!1,currentRoom:f}))},playing:x,onEnded:function(){h&&p&&(b(p[0]),j((function(e){return e.slice(1)})))},className:"react-player",url:w,width:"100%",height:"100%",controls:!0,volume:.1})),r.a.createElement("div",{className:"twitchChat",ref:y},r.a.createElement("span",{className:"onlineUsers"},u?"".concat(u," ONLINE"):"CONNECTING"),r.a.createElement("iframe",{style:{border:"2px solid #121212"},title:"TwitchChat",id:"chat_embed",src:"https://www.twitch.tv/embed/".concat(n,"/chat?darkpopout&parent=").concat(D),height:"100%",width:"100%"}))))}),Q=n(184),P=n(185);function V(e){return r.a.createElement(P.a,Object.assign({elevation:6,variant:"filled"},e))}var M=Object(d.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));function _(){var e=Object(a.useContext)(H),t=e.isSuccess,n=e.setIsSuccess,c=e.successMessage,o=M(),i=function(e,t){"clickaway"!==t&&n(!1)};return r.a.createElement("div",{className:o.root},r.a.createElement(Q.a,{open:t,autoHideDuration:1e3,onClose:i},r.a.createElement(V,{onClose:i,severity:"success"},c)))}function z(e){return r.a.createElement(P.a,Object.assign({elevation:6,variant:"filled"},e))}var F=Object(d.a)((function(e){return{root:{width:"100%","& > * + *":{marginTop:e.spacing(2)}}}}));function W(){var e=Object(a.useContext)(H),t=e.isError,n=e.setIsError,c=e.errorMessage,o=F(),i=function(e,t){"clickaway"!==t&&n(!1)};return r.a.createElement("div",{className:o.root},r.a.createElement(Q.a,{open:t,autoHideDuration:1e3,onClose:i},r.a.createElement(z,{onClose:i,severity:"error"},c)))}n(150);var B=function(){var e=Object(a.useContext)(H),t=e.twitchUserData,n=e.websiteURL,c=Object(l.f)(),o=Object(a.useState)(""),u=Object(i.a)(o,2),s=u[0],m=u[1];return r.a.createElement("div",{className:"home"},r.a.createElement("h1",null," Twitch Together"),r.a.createElement("h2",null,"Enter twitch streamer username"),r.a.createElement("form",null,r.a.createElement("input",{placeholder:"Channel",type:"text",value:s,onChange:function(e){return m(e.target.value)}}),r.a.createElement("button",{type:"submit",style:{display:"none"},onClick:function(e){e.preventDefault(),s&&c.push("/".concat(s))}}),t?r.a.createElement("div",{className:"userInfo"},r.a.createElement("a",{href:"".concat(n,"/#/").concat(t.login)},r.a.createElement("img",{src:t.image,alt:"Twitch"}),t.login)):r.a.createElement("div",{onClick:function(){window.location.href="".concat(n,"/auth/twitch")},className:"twitchButton"},"Login with Twitch")))},H=r.a.createContext(),q=s()("/"),G=function(){var e=Object(l.f)(),t=Object(a.useState)(!1),n=Object(i.a)(t,2),c=n[0],o=n[1],u=Object(a.useState)(""),s=Object(i.a)(u,2),m=s[0],d=s[1],f=Object(a.useState)([]),v=Object(i.a)(f,2),E=v[0],h=v[1],b=Object(a.useState)(2),w=Object(i.a)(b,2),g=w[0],O=w[1],p=Object(a.useState)(null),j=Object(i.a)(p,2),C=j[0],y=j[1],k=window.location.origin;Object(a.useEffect)((function(){fetch("https://noembed.com/embed?url=".concat(m)).then((function(e){return e.json()})).then((function(e){document.title=e.title,void 0===e.title&&(document.title="Watch Together")}))}),[m]),Object(a.useEffect)((function(){fetch("/getProfile",{credentials:"include"}).then((function(e){return e.json()})).then((function(e){e.profile&&y(e.profile)}))}),[]);var N=Object(a.useRef)(null);return r.a.createElement(r.a.Fragment,null,r.a.createElement(H.Provider,{value:{chatRef:N,websiteURL:k,twitchUserData:C,admin:c,setAdmin:o,socket:q,currentVideoLink:m,setCurrentVideoLink:d,history:e,videoQueue:E,setVideoQueue:h,maxDelay:g,setMaxDelay:O}},r.a.createElement("div",{className:"app"},r.a.createElement(l.c,null,r.a.createElement(l.a,{path:"/",exact:!0},r.a.createElement(B,null)),r.a.createElement(l.a,{path:"/:twitchStreamer",exact:!0},r.a.createElement(U,null),r.a.createElement("div",{className:"bottomDiv"},r.a.createElement(S,null)))),r.a.createElement(_,null),r.a.createElement(W,null))))},J=n(29);o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J.a,null,r.a.createElement(G,null))),document.getElementById("root"))}},[[101,13,14]]]);
//# sourceMappingURL=main.19dd870b.chunk.js.map